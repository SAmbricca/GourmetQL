<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Agregar Empleado | Cliente</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="empleado-container">
    
    <form [formGroup]="empleadoForm" (ngSubmit)="agregarEmpleado()">
      
      <div class="section-title center">Foto de Perfil</div>
      <div class="foto-container">
        <ion-avatar 
          class="avatar-grande" 
          [class.avatar-vacio]="!foto"
          (click)="tomarFoto()">
          @if (!foto) {
            <ion-icon name="camera" class="camera-overlay"></ion-icon>
          }
        </ion-avatar>
        <ion-button 
          fill="outline" 
          size="small" 
          (click)="tomarFoto()"
          class="btn-foto">
          <ion-icon name="camera" slot="start"></ion-icon>
          {{ foto ? 'Cambiar Foto' : 'Tomar Foto' }}
        </ion-button>
        @if (fotoError) {
          <ion-text color="danger">
            <p class="error-text">{{ fotoError }}</p>
          </ion-text>
        }
      </div>

      <ion-button 
        expand="block" 
        fill="outline" 
        color="secondary"
        (click)="escanearDNI()"
        class="qr-button">
        <ion-icon name="qr-code-outline" slot="start"></ion-icon>
        Escanear código QR del DNI
      </ion-button>
      
      <div class="input-container">
        <ion-input
          formControlName="nombre"
          placeholder="Nombre *"
          fill="outline"
          [class.ion-invalid]="nombreError"
          [class.ion-touched]="empleadoForm.get('nombre')?.touched">
        </ion-input>
        @if (nombreError) {
          <ion-text color="danger">
            <p class="error-text">{{ nombreError }}</p>
          </ion-text>
        }
      </div>

      <div class="input-container">
        <ion-input
          formControlName="apellido"
          placeholder="Apellido *"
          fill="outline"
          [class.ion-invalid]="apellidoError"
          [class.ion-touched]="empleadoForm.get('apellido')?.touched">
        </ion-input>
        @if (apellidoError) {
          <ion-text color="danger">
            <p class="error-text">{{ apellidoError }}</p>
          </ion-text>
        }
      </div>

      <div class="input-container">
        <ion-input
          formControlName="email"
          type="email"
          placeholder="Correo electrónico *"
          fill="outline"
          [class.ion-invalid]="emailError"
          [class.ion-touched]="empleadoForm.get('email')?.touched">
        </ion-input>
        @if (emailError) {
          <ion-text color="danger">
            <p class="error-text">{{ emailError }}</p>
          </ion-text>
        }
      </div>

      <div class="input-container">
        <ion-input
          formControlName="dni"
          type="number"
          placeholder="DNI (sin puntos) *"
          fill="outline"
          [class.ion-invalid]="dniError"
          [class.ion-touched]="empleadoForm.get('dni')?.touched">
        </ion-input>
        @if (dniError) {
          <ion-text color="danger">
            <p class="error-text">{{ dniError }}</p>
          </ion-text>
        }
      </div>

      <div class="input-container">
        <ion-input
          formControlName="cuil"
          placeholder="CUIL (XX-XXXXXXXX-X) *"
          fill="outline"
          [class.ion-invalid]="cuilError"
          [class.ion-touched]="empleadoForm.get('cuil')?.touched">
        </ion-input>
        @if (cuilError) {
          <ion-text color="danger">
            <p class="error-text">{{ cuilError }}</p>
          </ion-text>
        }
      </div>

      <div class="input-container">
        <ion-input
          formControlName="contrasenia"
          type="password"
          placeholder="Contraseña *"
          fill="outline"
          [class.ion-touched]="empleadoForm.get('contrasenia')?.touched">
        </ion-input>
      </div>

      <div class="section-title">Perfil del Empleado</div>
      
      <div class="input-container">
        <ion-select 
          formControlName="perfil" 
          placeholder="Seleccione un perfil *"
          fill="outline"
          interface="action-sheet">
          @for (perfil of perfilesDisponibles; track perfil) {
            <ion-select-option [value]="perfil">
              {{ perfil | titlecase }}
            </ion-select-option>
          }
        </ion-select>
      </div>

      <div class="button-container">
        <ion-button 
          expand="block" 
          type="submit"
          class="register-button">
          <ion-icon name="person-add-outline" slot="start"></ion-icon>
          @if (cargando) {
            Agregando empleado...
          } @else {
            Agregar Empleado
          }
        </ion-button>

        <ion-button 
          expand="block" 
          fill="outline"
          color="medium"
          (click)="navegarAHome()"
          class="cancel-button">
          <ion-icon name="close-outline" slot="start"></ion-icon>
          Cancelar
        </ion-button>
      </div>
    </form>
    
  </div>
</ion-content>